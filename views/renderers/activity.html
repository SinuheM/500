<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>500.co</title>
    <link rel="stylesheet" href="/css/foundation.css" />
    <link rel="stylesheet" href="/css/500.css" />
    <script src="/js/vendor/modernizr.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Exo+2:300,400,500,600,700,800' rel='stylesheet' type='text/css'>
</head>
<body>
	{% include "../partials/navbar.html" %}
    <section id="activity">
        <div class="center">
            <h4 class="text-center">The latest news and updates from 500!</h4>
            <ul class="filter">
                <li {% if !filter %}class="active"{% endif %}><a href="">ALL</a></li>
                <li {% if filter == 'announcements' %}class="active"{% endif %}><a href="/announcements">ANNOUNCEMENTS</a></li>
                <li {% if filter == 'post' %}class="active"{% endif %}><a href="/blog">BLOG POSTS</a></li>
                <li {% if filter == 'podcast' %}class="active"{% endif %}><a href="/podcast">PODCASTS</a></li>
                <li {% if filter == 'video' %}class="active"{% endif %}><a href="/videos">VIDEOS</a></li>
                <li><a href="/on-the-web">ON THE WEB</a></li>
            </ul>
            <div class="clearfix"></div>
            <ul id="activity-list">
            	{% for activity in activities %}
                {% if activity.type == 'post'%}
                    {% if activity.announcement%}
                    <li class="announcement">
                        <div class="row-2">
                            <span>1 day ago</span>
                            <span class="tag">OFFICIAL ANNOUNCEMENT</span>
                        </div>
                    {% else%}
                    <li class="blog">
                        <div class="row-2">
                            <span class="refresh-time" data-time="{{activity.createdDate|dateToString}}">{{activity.createdDate|ago}}</span>
                            <span class="tag">ON OUR BLOG</span>
                        </div>                    
                    {% endif %}
                        <div class="row-10">
                            <a href="/{{activity.slugStr}}">
                                <h5>{{activity.title}}</h5>
                                <div class="info">
                                    <div class="image"><img src="{{ activity.image }}"></div>
                                    <div class="detail">
                                        <p>{{activity.description}}</p>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="meta">
                                    {% if activity.uploader %}
                                    <span>ADDED BY</span> {{activity.uploader.displayName}}
                                    {% endif %}
                                </div>
                            </a>
                        </div>
                    </li>
                {% elseif activity.type == 'podcast'%}
                <li class="podcast">
                    <div class="row-2">
                        <span class="refresh-time" data-time="{{activity.createdDate|dateToString}}">{{activity.createdDate|ago}}</span>
                        <span class="tag">PODCAST</span>
                    </div>
                    <div class="row-10">
                        <a href="/{{ activity.slugStr }}"><h5>{{ activity.title }}</h5></a>
                        <div class="info">
                            {{activity.content|safe}}
                        </div>
                        <div class="clearfix"></div>
                        <div class="meta">
                            {% if activity.uploader %}
                            <span>ADDED BY</span> {{activity.uploader.displayName}}
                            {% endif %}
                        </div>
                    </div>
                </li>
                {% elseif activity.type == 'video'%}
                <li class="video">
                    <div class="row-2">
                        <span class="refresh-time" data-time="{{activity.createdDate|dateToString}}">{{activity.createdDate|ago}}</span>
                        <span class="icon"><img src="{{ activity.favicon }}"></span>
                    </div>
                    <div class="row-10">
                        <h5>{{ activity.title }}</h5>
                        <div class="detail">
                            <p>{{activity.description}}</p>
                        </div>                        
                        <div class="info">
                            <div class="video">{{ activity.media|safe }}</div>
                        </div>
                        <div class="clearfix"></div>
                        <div class="meta">
                            {% if activity.uploader %}
                            <span>ADDED BY</span> {{activity.uploader.displayName}}
                            {% endif %}
                        </div>
                    </div>
                </li>                
                {% else%}
                    {% if activity.provider == "twitter.com"%}
                    <li class="twitt">
                        <div class="row-2">
                            <span class="refresh-time" data-time="{{activity.createdDate|dateToString}}">{{activity.createdDate|ago}}</span>
                            <span class="icon"><img src="{{ activity.favicon }}"></span>
                        </div>
                        <div class="row-10">
                            <h5><a class="twitt-body" href="{{ activity.url }}">{{ activity.description }}</a> by <a href="{{ activity.author.url }}">@ {{ activity.author.name }}</a></span></h5>
                            <div class="">
                                <div class="image"><img src="{{ activity.image }}"></div>
                            </div>                            
                            <div class="clearfix"></div>
                            <div class="meta">
                                {% if activity.uploader %}
                                <span>ADDED BY</span> {{activity.uploader.displayName}}
                                {% endif %}
                            </div>
                        </div>
                    </li>                    
                    {% else %}
                    <li class="normal">
                        <div class="row-2">
                            <span class="refresh-time" data-time="{{activity.createdDate|dateToString}}">{{activity.createdDate|ago}}</span>
                            <span class="icon"><img src="{{activity.favicon}}"></span>
                        </div>
                        <div class="row-10">
                            <h5><a href="{{activity.url}}">{{activity.title}} <span>{{activity.provider}}</span></a></h5>
                            <div class="info">
                                <a href="{{activity.url}}">
                                    <div class="detail">
                                        <img src="{{activity.image}}">
                                        <p>{{activity.description}}</p>
                                    </div>
                                </a>
                            </div>
                            <div class="clearfix"></div>
                            <div class="meta">
                                {% if activity.uploader %}
                                <span>ADDED BY</span> {{activity.uploader.displayName}}
                                {% endif %}
                            </div>
                        </div>
                    </li>
                    {% endif %}
                {% endif %}
                {% endfor %}

                {% if hasNext %}
                <li>
                    <a class="jscroll-next" href="/utils/next-activities?page={{page}}&type={{filter}}">More...</a>
                </li>
                {% endif %}
            </ul>
            <div class="clearfix"></div>
        </div>
    </section>
    {% include "../partials/footer.html" %}
<script src="/js/vendors/moment.min.js"></script>
<script src="/js/vendor/jquery.js"></script>
<script src="/js/foundation.min.js"></script>
<script src="/js/vendors/jquery.jscroll.min.js"></script>
<script src="/js/app/activity.js"></script>
<script>
    window.calculateSizes = function(){
        $('.announcement .image img, .blog .image img').each(function(i, img){
            var $img = $(img);
            $img.css('top', -1 * (($img.height() / 2) - 100) )
        });

        $('li.video iframe').each(function(i, iframe){
            var $iframe = $(iframe);
            var aspectRatio = $iframe.height() / $iframe.width();

            $iframe.css('width', '100%');
            $iframe.css('height', $iframe.width() * aspectRatio);
        });
    }

    $(document).foundation();
    $(document).ready(function () {
        window.calculateSizes();

        {% if hasNext %}
        $('#activity-list').jscroll({
            loadingHtml: '<div class="load">LOADING...</div>',
            nextSelector: 'a.jscroll-next',
            contentSelector: '#activity-list li',
            callback : function(){
                $('#activity-list img').each(function(i, img){
                    $(img).on('load', window.calculateSizes);
                });
            }
        });
        {% endif %}
    });

    $(window).resize(window.calculateSizes);
    $(window).load(window.calculateSizes);
</script>
</body>
</html>